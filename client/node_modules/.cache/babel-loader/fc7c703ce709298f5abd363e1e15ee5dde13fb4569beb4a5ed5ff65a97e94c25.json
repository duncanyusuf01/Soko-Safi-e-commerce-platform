{"ast":null,"code":"import React,{useState,useEffect}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ChatInterface(_ref){let{partnerId,partnerName}=_ref;const[messages,setMessages]=useState([]);const[newMessage,setNewMessage]=useState('');const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{const fetchMessages=async()=>{try{setLoading(true);const response=await fetch(\"/messages/\".concat(partnerId));if(!response.ok)throw new Error('Failed to load messages');const data=await response.json();setMessages(Array.isArray(data)?data:[]);}catch(err){console.error(\"Error fetching messages:\",err);setError(err.message);}finally{setLoading(false);}};if(partnerId){fetchMessages();}},[partnerId]);const sendMessage=async()=>{if(!newMessage.trim())return;try{const response=await fetch('/messages',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({content:newMessage,recipient_id:partnerId})});if(response.ok){const message=await response.json();setMessages(prev=>[...prev,message]);setNewMessage('');}}catch(err){console.error(\"Error sending message:\",err);}};if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-3\",children:\"Loading messages...\"});if(error)return/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",children:error});return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column border rounded shadow-sm\",style:{height:'500px'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"border-bottom px-3 py-2 bg-light\",children:/*#__PURE__*/_jsxs(\"h5\",{className:\"mb-0\",children:[\"Chat with \",partnerName]})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-grow-1 overflow-auto p-3\",style:{backgroundColor:'#f8f9fa'},children:messages.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"No messages yet. Start the conversation!\"}):messages.map(msg=>/*#__PURE__*/_jsx(\"div\",{className:\"mb-3 d-flex \".concat(msg.sender_id===partnerId?'justify-content-start':'justify-content-end'),children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-2 rounded \".concat(msg.sender_id===partnerId?'bg-secondary text-white':'bg-primary text-white'),children:msg.content}),/*#__PURE__*/_jsx(\"div\",{className:\"small text-muted text-end mt-1\",children:new Date(msg.timestamp).toLocaleTimeString()})]})},msg.id))}),/*#__PURE__*/_jsx(\"div\",{className:\"border-top p-3 bg-white\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",value:newMessage,onChange:e=>setNewMessage(e.target.value),onKeyDown:e=>e.key==='Enter'&&sendMessage(),placeholder:\"Type your message...\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:sendMessage,children:\"Send\"})]})})]});}export default ChatInterface;","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","ChatInterface","_ref","partnerId","partnerName","messages","setMessages","newMessage","setNewMessage","loading","setLoading","error","setError","fetchMessages","response","fetch","concat","ok","Error","data","json","Array","isArray","err","console","message","sendMessage","trim","method","headers","body","JSON","stringify","content","recipient_id","prev","className","children","style","height","backgroundColor","length","map","msg","sender_id","Date","timestamp","toLocaleTimeString","id","type","value","onChange","e","target","onKeyDown","key","placeholder","onClick"],"sources":["/home/yusuf12148/moringa/Soko-Safi-e-commerce-platform/client/src/components/ChatInterface.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\n\nfunction ChatInterface({ partnerId, partnerName }) {\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    const fetchMessages = async () => {\n      try {\n        setLoading(true);\n        const response = await fetch(`/messages/${partnerId}`);\n        if (!response.ok) throw new Error('Failed to load messages');\n        const data = await response.json();\n        setMessages(Array.isArray(data) ? data : []);\n      } catch (err) {\n        console.error(\"Error fetching messages:\", err);\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    if (partnerId) {\n      fetchMessages();\n    }\n  }, [partnerId]);\n\n  const sendMessage = async () => {\n    if (!newMessage.trim()) return;\n\n    try {\n      const response = await fetch('/messages', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          content: newMessage,\n          recipient_id: partnerId\n        })\n      });\n\n      if (response.ok) {\n        const message = await response.json();\n        setMessages(prev => [...prev, message]);\n        setNewMessage('');\n      }\n    } catch (err) {\n      console.error(\"Error sending message:\", err);\n    }\n  };\n\n  if (loading) return <div className=\"text-center py-3\">Loading messages...</div>;\n  if (error) return <div className=\"alert alert-danger\">{error}</div>;\n\n  return (\n    <div className=\"d-flex flex-column border rounded shadow-sm\" style={{ height: '500px' }}>\n      <div className=\"border-bottom px-3 py-2 bg-light\">\n        <h5 className=\"mb-0\">Chat with {partnerName}</h5>\n      </div>\n\n      <div className=\"flex-grow-1 overflow-auto p-3\" style={{ backgroundColor: '#f8f9fa' }}>\n        {messages.length === 0 ? (\n          <p className=\"text-muted\">No messages yet. Start the conversation!</p>\n        ) : (\n          messages.map(msg => (\n            <div\n              key={msg.id}\n              className={`mb-3 d-flex ${msg.sender_id === partnerId ? 'justify-content-start' : 'justify-content-end'}`}\n            >\n              <div>\n                <div className={`p-2 rounded ${msg.sender_id === partnerId ? 'bg-secondary text-white' : 'bg-primary text-white'}`}>\n                  {msg.content}\n                </div>\n                <div className=\"small text-muted text-end mt-1\">\n                  {new Date(msg.timestamp).toLocaleTimeString()}\n                </div>\n              </div>\n            </div>\n          ))\n        )}\n      </div>\n\n      <div className=\"border-top p-3 bg-white\">\n        <div className=\"input-group\">\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            value={newMessage}\n            onChange={(e) => setNewMessage(e.target.value)}\n            onKeyDown={(e) => e.key === 'Enter' && sendMessage()}\n            placeholder=\"Type your message...\"\n          />\n          <button className=\"btn btn-primary\" onClick={sendMessage}>\n            Send\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default ChatInterface;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}