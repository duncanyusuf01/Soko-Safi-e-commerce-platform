{"ast":null,"code":"import _objectSpread from\"/home/yusuf12148/moringa/Soko-Safi-e-commerce-platform/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useContext,useState,useEffect}from'react';import{UserContext}from'../context/UserProvider';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function CartPage(){const{user}=useContext(UserContext);const[cart,setCart]=useState([]);const navigate=useNavigate();useEffect(()=>{const savedCart=localStorage.getItem('cart');if(savedCart){setCart(JSON.parse(savedCart));}},[]);const removeFromCart=productId=>{const updatedCart=cart.filter(item=>item.product_id!==productId);setCart(updatedCart);localStorage.setItem('cart',JSON.stringify(updatedCart));};const updateQuantity=(productId,newQuantity)=>{const updatedCart=cart.map(item=>item.product_id===productId?_objectSpread(_objectSpread({},item),{},{quantity:newQuantity}):item);setCart(updatedCart);localStorage.setItem('cart',JSON.stringify(updatedCart));};const placeOrder=async()=>{if(!user){navigate('/login');return;}try{const response=await fetch('/orders',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({cart})});if(response.ok){localStorage.removeItem('cart');setCart([]);alert('Order placed successfully!');navigate('/profile');}else{const errorData=await response.json();alert(\"Error: \".concat(errorData.error));}}catch(error){console.error('Error placing order:',error);alert('Failed to place order. Please try again.');}};const totalPrice=cart.reduce((sum,item)=>sum+item.price*item.quantity,0);return/*#__PURE__*/_jsxs(\"div\",{className:\"container py-5\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mb-4 text-center\",children:\"Your Cart\"}),cart.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info text-center\",children:\"Your cart is empty\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"ul\",{className:\"list-group mb-4\",children:cart.map(item=>/*#__PURE__*/_jsxs(\"li\",{className:\"list-group-item d-flex justify-content-between align-items-center flex-wrap\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow-1\",children:[/*#__PURE__*/_jsx(\"h5\",{children:item.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"mb-1 text-muted\",children:[\"$\",item.price.toFixed(2),\" each\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"1\",className:\"form-control\",style:{width:'70px'},value:item.quantity,onChange:e=>updateQuantity(item.product_id,parseInt(e.target.value))}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-danger btn-sm\",onClick:()=>removeFromCart(item.product_id),children:\"Remove\"})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"strong\",{children:[\"$\",(item.price*item.quantity).toFixed(2)]})})]},item.product_id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-end\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"mb-3\",children:[\"Total: $\",totalPrice.toFixed(2)]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success px-4\",onClick:placeOrder,children:\"Place Order\"})]})]})]});}export default CartPage;","map":{"version":3,"names":["React","useContext","useState","useEffect","UserContext","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CartPage","user","cart","setCart","navigate","savedCart","localStorage","getItem","JSON","parse","removeFromCart","productId","updatedCart","filter","item","product_id","setItem","stringify","updateQuantity","newQuantity","map","_objectSpread","quantity","placeOrder","response","fetch","method","headers","body","ok","removeItem","alert","errorData","json","concat","error","console","totalPrice","reduce","sum","price","className","children","length","name","toFixed","type","min","style","width","value","onChange","e","parseInt","target","onClick"],"sources":["/home/yusuf12148/moringa/Soko-Safi-e-commerce-platform/client/src/pages/CartPage.js"],"sourcesContent":["import React, { useContext, useState, useEffect } from 'react';\nimport { UserContext } from '../context/UserProvider';\nimport { useNavigate } from 'react-router-dom';\n\nfunction CartPage() {\n    const { user } = useContext(UserContext);\n    const [cart, setCart] = useState([]);\n    const navigate = useNavigate();\n\n    useEffect(() => {\n        const savedCart = localStorage.getItem('cart');\n        if (savedCart) {\n            setCart(JSON.parse(savedCart));\n        }\n    }, []);\n\n    const removeFromCart = (productId) => {\n        const updatedCart = cart.filter(item => item.product_id !== productId);\n        setCart(updatedCart);\n        localStorage.setItem('cart', JSON.stringify(updatedCart));\n    };\n\n    const updateQuantity = (productId, newQuantity) => {\n        const updatedCart = cart.map(item =>\n            item.product_id === productId ? { ...item, quantity: newQuantity } : item\n        );\n        setCart(updatedCart);\n        localStorage.setItem('cart', JSON.stringify(updatedCart));\n    };\n\n    const placeOrder = async () => {\n        if (!user) {\n            navigate('/login');\n            return;\n        }\n\n        try {\n            const response = await fetch('/orders', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ cart })\n            });\n\n            if (response.ok) {\n                localStorage.removeItem('cart');\n                setCart([]);\n                alert('Order placed successfully!');\n                navigate('/profile');\n            } else {\n                const errorData = await response.json();\n                alert(`Error: ${errorData.error}`);\n            }\n        } catch (error) {\n            console.error('Error placing order:', error);\n            alert('Failed to place order. Please try again.');\n        }\n    };\n\n    const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);\n\n    return (\n        <div className=\"container py-5\">\n            <h1 className=\"mb-4 text-center\">Your Cart</h1>\n            {cart.length === 0 ? (\n                <div className=\"alert alert-info text-center\">Your cart is empty</div>\n            ) : (\n                <>\n                    <ul className=\"list-group mb-4\">\n                        {cart.map(item => (\n                            <li\n                                key={item.product_id}\n                                className=\"list-group-item d-flex justify-content-between align-items-center flex-wrap\"\n                            >\n                                <div className=\"flex-grow-1\">\n                                    <h5>{item.name}</h5>\n                                    <p className=\"mb-1 text-muted\">${item.price.toFixed(2)} each</p>\n                                </div>\n                                <div className=\"d-flex align-items-center gap-2\">\n                                    <input\n                                        type=\"number\"\n                                        min=\"1\"\n                                        className=\"form-control\"\n                                        style={{ width: '70px' }}\n                                        value={item.quantity}\n                                        onChange={(e) =>\n                                            updateQuantity(item.product_id, parseInt(e.target.value))\n                                        }\n                                    />\n                                    <button\n                                        className=\"btn btn-outline-danger btn-sm\"\n                                        onClick={() => removeFromCart(item.product_id)}\n                                    >\n                                        Remove\n                                    </button>\n                                </div>\n                                <div>\n                                    <strong>${(item.price * item.quantity).toFixed(2)}</strong>\n                                </div>\n                            </li>\n                        ))}\n                    </ul>\n                    <div className=\"text-end\">\n                        <h4 className=\"mb-3\">Total: ${totalPrice.toFixed(2)}</h4>\n                        <button className=\"btn btn-success px-4\" onClick={placeOrder}>\n                            Place Order\n                        </button>\n                    </div>\n                </>\n            )}\n        </div>\n    );\n}\n\nexport default CartPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}