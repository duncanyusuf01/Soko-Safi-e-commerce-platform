{"ast":null,"code":"import React,{useState,useEffect,useContext}from'react';import{useParams,useNavigate}from'react-router-dom';import{UserContext}from'../context/UserProvider';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ProductDetailPage(){const{id}=useParams();const{user}=useContext(UserContext);const navigate=useNavigate();const[product,setProduct]=useState(null);const[loading,setLoading]=useState(true);const[quantity,setQuantity]=useState(1);useEffect(()=>{const fetchProduct=async()=>{try{const response=await fetch(\"/products/\".concat(id));if(response.ok){const data=await response.json();setProduct(data);}else{navigate('/');}}catch(error){console.error(\"Error fetching product:\",error);navigate('/');}finally{setLoading(false);}};fetchProduct();},[id,navigate]);const addToCart=()=>{const cartItem={product_id:product.id,name:product.name,price:product.price,quantity:quantity};const existingCart=JSON.parse(localStorage.getItem('cart'))||[];const existingItemIndex=existingCart.findIndex(item=>item.product_id===product.id);if(existingItemIndex>=0){existingCart[existingItemIndex].quantity+=quantity;}else{existingCart.push(cartItem);}localStorage.setItem('cart',JSON.stringify(existingCart));alert('Added to cart!');};if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"text-center my-5\",children:\"Loading product...\"});if(!product)return/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-danger my-5\",children:\"Product not found\"});return/*#__PURE__*/_jsx(\"div\",{className:\"container py-5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row g-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsx(\"img\",{src:product.image_url,alt:product.name,className:\"img-fluid rounded shadow-sm\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mb-3\",children:product.name}),/*#__PURE__*/_jsxs(\"h4\",{className:\"text-primary mb-4\",children:[\"$\",product.price.toFixed(2)]}),/*#__PURE__*/_jsx(\"p\",{className:\"mb-4\",children:product.description}),/*#__PURE__*/_jsxs(\"p\",{className:\"mb-4\",children:[\"Sold by:\",' ',/*#__PURE__*/_jsx(\"a\",{href:\"/vendors/\".concat(product.vendor.id),className:\"text-decoration-underline\",children:product.vendor.username})]}),(user===null||user===void 0?void 0:user.role)==='customer'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 d-flex align-items-center gap-3\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"quantity\",className:\"form-label m-0\",children:\"Quantity:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"quantity\",min:\"1\",value:quantity,onChange:e=>setQuantity(Math.max(1,parseInt(e.target.value))),className:\"form-control\",style:{width:'80px'}})]}),/*#__PURE__*/_jsx(\"button\",{onClick:addToCart,className:\"btn btn-primary\",children:\"Add to Cart\"})]}),(user===null||user===void 0?void 0:user.id)===product.vendor.id&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/products/\".concat(product.id,\"/edit\")),className:\"btn btn-success me-2\",children:\"Edit Product\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{},className:\"btn btn-danger\",children:\"Delete Product\"})]})]})]})});}export default ProductDetailPage;","map":{"version":3,"names":["React","useState","useEffect","useContext","useParams","useNavigate","UserContext","jsx","_jsx","jsxs","_jsxs","ProductDetailPage","id","user","navigate","product","setProduct","loading","setLoading","quantity","setQuantity","fetchProduct","response","fetch","concat","ok","data","json","error","console","addToCart","cartItem","product_id","name","price","existingCart","JSON","parse","localStorage","getItem","existingItemIndex","findIndex","item","push","setItem","stringify","alert","className","children","src","image_url","alt","toFixed","description","href","vendor","username","role","htmlFor","type","min","value","onChange","e","Math","max","parseInt","target","style","width","onClick"],"sources":["/home/yusuf12148/moringa/Soko-Safi-e-commerce-platform/client/src/pages/ProductDetailPage.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { UserContext } from '../context/UserProvider';\n\nfunction ProductDetailPage() {\n    const { id } = useParams();\n    const { user } = useContext(UserContext);\n    const navigate = useNavigate();\n    const [product, setProduct] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [quantity, setQuantity] = useState(1);\n\n    useEffect(() => {\n        const fetchProduct = async () => {\n            try {\n                const response = await fetch(`/products/${id}`);\n                if (response.ok) {\n                    const data = await response.json();\n                    setProduct(data);\n                } else {\n                    navigate('/');\n                }\n            } catch (error) {\n                console.error(\"Error fetching product:\", error);\n                navigate('/');\n            } finally {\n                setLoading(false);\n            }\n        };\n        fetchProduct();\n    }, [id, navigate]);\n\n    const addToCart = () => {\n        const cartItem = {\n            product_id: product.id,\n            name: product.name,\n            price: product.price,\n            quantity: quantity\n        };\n\n        const existingCart = JSON.parse(localStorage.getItem('cart')) || [];\n        const existingItemIndex = existingCart.findIndex(item => item.product_id === product.id);\n\n        if (existingItemIndex >= 0) {\n            existingCart[existingItemIndex].quantity += quantity;\n        } else {\n            existingCart.push(cartItem);\n        }\n\n        localStorage.setItem('cart', JSON.stringify(existingCart));\n        alert('Added to cart!');\n    };\n\n    if (loading) return <div className=\"text-center my-5\">Loading product...</div>;\n    if (!product) return <div className=\"text-center text-danger my-5\">Product not found</div>;\n\n    return (\n        <div className=\"container py-5\">\n            <div className=\"row g-5\">\n                {/* Product Image */}\n                <div className=\"col-md-6\">\n                    <img\n                        src={product.image_url}\n                        alt={product.name}\n                        className=\"img-fluid rounded shadow-sm\"\n                    />\n                </div>\n\n                {/* Product Details */}\n                <div className=\"col-md-6\">\n                    <h1 className=\"mb-3\">{product.name}</h1>\n                    <h4 className=\"text-primary mb-4\">${product.price.toFixed(2)}</h4>\n                    <p className=\"mb-4\">{product.description}</p>\n\n                    <p className=\"mb-4\">\n                        Sold by:{' '}\n                        <a href={`/vendors/${product.vendor.id}`} className=\"text-decoration-underline\">\n                            {product.vendor.username}\n                        </a>\n                    </p>\n\n                    {/* Customer Actions */}\n                    {user?.role === 'customer' && (\n                        <div className=\"mb-4\">\n                            <div className=\"mb-3 d-flex align-items-center gap-3\">\n                                <label htmlFor=\"quantity\" className=\"form-label m-0\">\n                                    Quantity:\n                                </label>\n                                <input\n                                    type=\"number\"\n                                    id=\"quantity\"\n                                    min=\"1\"\n                                    value={quantity}\n                                    onChange={(e) => setQuantity(Math.max(1, parseInt(e.target.value)))}\n                                    className=\"form-control\"\n                                    style={{ width: '80px' }}\n                                />\n                            </div>\n                            <button onClick={addToCart} className=\"btn btn-primary\">\n                                Add to Cart\n                            </button>\n                        </div>\n                    )}\n\n                    {/* Vendor Actions */}\n                    {user?.id === product.vendor.id && (\n                        <div className=\"mt-4\">\n                            <button\n                                onClick={() => navigate(`/products/${product.id}/edit`)}\n                                className=\"btn btn-success me-2\"\n                            >\n                                Edit Product\n                            </button>\n                            <button\n                                onClick={() => {\n\n                                }}\n                                className=\"btn btn-danger\"\n                            >\n                                Delete Product\n                            </button>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default ProductDetailPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}